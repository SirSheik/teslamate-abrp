# TeslaMate: MQTT to ABRP

## Use as Docker container
*TODO*

## Use as python script
The script can also be run directly on a machine with Python 3.x. Please note that the machine needs to have access to your MQTT server on port 1883.

### Installing requirements
To install the requirements, run
```
pip install -r requirements.txt
```

### Running

To run, you can either use the CLI. Please note that USER_TOKEN, CAR_NUMBER, CAR_MODEL and MQTT_SERVER are required arguments.  
  
If you are using a MQTT server with username or authentication, pass the -l (to use MQTT_USERNAME only) or -a (for authentication with MQTT_USERNAME and MQTT_PASSWORD) options.

  
```
  Usage: 
    teslamate_mqtt2abrp.py [-hlap] (USER_TOKEN) (CAR_NUMBER) (CAR_MODEL) (MQTT_SERVER) [MQTT_USERNAME] [MQTT_PASSWORD]
  
  Arguments:
    USER_TOKEN          User token generated by ABRP
    CAR_NUMBER          Car number from TeslaMate (usually 1)
    CAR_MODEL           Car model (from https://api.iternio.com/1/tlm/get_carmodels_list, e.g. "s100d" for a 2012-2018 S100D)
    MQTT_SERVER         MQTT server address or hostname (e.g. "192.168.1.1")
    MQTT_USERNAME       MQTT username (e.g. "teslamate") - use with -l or -a.
    MQTT_PASSWORD       MQTT password (e.g. "etamalset") - use with -a.

  Options:
    -h                  Show this screen.
    -l                  Use username to connect to MQTT server.
    -a                  Use authentification (user and password) to connect to MQTT server.
```
**Note: All arguments can also be passed as corresponding OS environment variables.** Arguments passed through the CLI will always supersede OS environment variables.

